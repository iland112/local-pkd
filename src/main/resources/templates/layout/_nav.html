<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<!-- Main Navigation Bar -->
<nav th:fragment="nav-content" class="bg-base-100 shadow-lg border-b border-base-300 sticky top-0 z-40">
    <div class="container mx-auto max-w-7xl">
        <div class="flex items-center justify-between h-16 px-4">
            <!-- Mobile menu toggle and Logo/Brand -->
            <div class="flex items-center space-x-4">
                <label for="main-drawer" class="btn btn-ghost drawer-button lg:hidden">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-5 h-5 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
                </label>
                <a href="/" class="flex items-center space-x-3 hover:opacity-80 transition-opacity">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-shield-alt text-white text-lg"></i>
                    </div>
                    <div class="hidden md:block">
                        <h1 class="text-xl font-bold text-base-content">ICAO Local PKD Manager</h1>
                        <p class="text-xs text-base-content">CSCA MasterList,DSC,CRL,DL from which downloaded ICAO Management System</p>
                    </div>
                </a>
            </div>

            <!--데스크톱 네비게이션 메뉴 -->
            <div class="hidden md:flex items-center space-x-1">
                <a href="/"
                   th:class="'px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 flex items-center gap-2 ' + (${currentPage} == 'home' ? 'bg-primary text-primary-content' : 'text-base-content hover:text-primary hover:bg-base-200')"
                >
                    <i class="fas fa-home"></i>
                    대시보드
                </a>
                <a href="/file/upload"
                   th:class="'px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 flex items-center gap-2 ' + (${currentPage} == 'file-upload' ? 'bg-primary text-primary-content' : 'text-base-content hover:text-primary hover:bg-base-200')"
                >
                    <i class="fas fa-file-upload"></i>
                    파일 업로드
                </a>
                <a href="/upload-history"
                   th:class="'px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 flex items-center gap-2 ' + (${currentPage} == 'upload-history' ? 'bg-primary text-primary-content' : 'text-base-content hover:text-primary hover:bg-base-200')"
                >
                    <i class="fas fa-history"></i>
                    업로드 이력
                </a>
            </div>

            <!-- 우측 유틸리티 메뉴 -->
            <div class="flex items-center space-x-3 z-50">
                <!-- 다크 모드 토글 버튼 -->
                <button
                  @click="toggleDarkMode()"
                  class="p-2 text-base-content hover:text-primary hover:bg-base-200 rounded-md transition-colors duration-200"
                  aria-label="다크 모드 토글"
                >
                  <i class="fas" :class="darkMode ? 'fa-moon' : 'fa-sun'"></i>
                </button>

                <!--  도구 드롭다운 -->
                <div class="relative" x-data="{open: false}">

                  <button
                    @click="open = !open"
                    @click.away="open = false"
                    class="p-2 text-base-content hover:text-primary hover:bg-base-200 rounded-md transition-colors duration-200"
                    aria-label="도구 메뉴"
                  >
                    <i class="fas fa-cog"></i>
                  </button>
                  <div
                    x-show="open"
                    x-transition:enter="transition ease-out duration-100"
                    x-transition:enter-start="transform opacity-0 scale-95"
                    x-transition:enter-end="transform opacity-100 scale-100"
                    x-transition:leave="transition ease-in duration-75"
                    x-transition:leave-start="transform opacity-100 scale-100"
                    x-transition:leave-end="transform opacity-0 scale-95"
                    class="absolute right-0 mt-2 w-48 bg-base-100 rounded-md shadow-lg py-1 border border-base-300"
                    style="display: none;"
                  >
                    <button
                      @click="showSystemInfo()"
                      class="w-full text-left px-4 py-2 text-sm text-base-content hover:bg-base-200 flex items-center gap-2"
                    >
                      <i class="fas fa-info-circle"></i>
                      시스템 정보
                    </button>
                    <button
                      @click="showHelp()"
                      class="w-full text-left px-4 py-2 text-sm text-base-content hover:bg-base-200 flex items-center gap-2"
                    >
                      <i class="fas fa-question-circle"></i>
                      도움말
                    </button>
                  </div>
                </div>
              </div> 
            </div>
          </div>
    </nav>

<!-- Drawer Side Content for Mobile -->
<div th:fragment="drawer-side-content" class="drawer-side z-50">
    <label for="main-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
    <ul class="menu p-4 w-80 min-h-full bg-base-200 text-base-content">
        <li>
            <a href="/" th:classappend="${currentPage} == 'home' ? 'active' : ''">
              <i class="fas fa-home"></i>
              대시보드
            </a>
        </li>
        <li>
            <a href="/file/upload" th:classappend="${currentPage} == 'file-upload' ? 'active' : ''">
              <i class="fas fa-file-upload"></i>
              파일 업로드
            </a>
        </li>
        <li>
            <a href="/upload-history" th:classappend="${currentPage} == 'upload-history' ? 'active' : ''">
              <i class="fas fa-history"></i>
              업로드 이력
            </a>
        </li>
        <div class="divider"></div>
        <li>
            <a @click="showSystemInfo()">
              <i class="fas fa-info-circle"></i>
              시스템 정보
            </a>
        </li>
        <li>
            <a @click="showHelp()">
              <i class="fas fa-question-circle"></i>
              도움말
            </a>
        </li>
        <li>
            <button @click="toggleDarkMode()">
              <i class="fas" :class="darkMode ? 'fa-moon' : 'fa-sun'"></i>
              <span x-text="darkMode ? '다크 모드' : '라이트 모드'"></span>
            </button>
        </li>
    </ul>
</div>
</html>