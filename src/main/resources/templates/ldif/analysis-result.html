<!DOCTYPE html>
<html
  lang="en"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{layout/main}"
>
  <body>
    <div layout:fragment="content">
      <div class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Header -->
        <div class="mb-6">
          <div class="flex items-center justify-between">
            <div>
              <h1 class="text-3xl font-bold text-gray-900 flex items-center">
                <i class="fas fa-chart-line mr-3"></i> PKD LDIF 분석 결과
              </h1>
              <p class="text-gray-600 mt-1">
                세션ID:
                <span
                  th:text="${sessionId}"
                  class="font-medium text-blue-600"
                ></span>
              </p>
              <p class="text-gray-600 mt-1">
                파일:
                <span
                  th:text="${fileName}"
                  class="font-medium text-blue-600"
                ></span>
              </p>
            </div>
            <a
              href="/ldif"
              class="inline-flex items-center px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors shadow-md hover:shadow-lg"
            >
              <i class="fas fa-arrow-left mr-2"></i> 돌아가기
            </a>
          </div>
        </div>

        <!-- Alert Messages -->
        <div
          th:if="${error}"
          class="bg-red-50 border border-red-200 rounded-lg p-4 mb-6 animate-fadeIn"
          role="alert"
        >
          <div class="flex items-center">
            <i class="fas fa-exclamation-triangle text-red-500 mr-2"></i>
            <span th:text="${error}" class="text-red-800"></span>
            <button
              type="button"
              class="ml-auto text-red-400 hover:text-red-600"
              onclick="this.parentElement.parentElement.remove()"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>

        <div
          th:if="${success}"
          class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6 animate-fadeIn"
          role="alert"
        >
          <div class="flex items-center">
            <i class="fas fa-check-circle text-green-500 mr-2"></i>
            <span th:text="${success}" class="text-green-800"></span>
            <button
              type="button"
              class="ml-auto text-green-400 hover:text-green-600"
              onclick="this.parentElement.parentElement.remove()"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>

        <div
          th:if="${warning}"
          class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6 animate-fadeIn"
          role="alert"
        >
          <div class="flex items-center">
            <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>
            <span th:text="${warning}" class="text-yellow-800"></span>
            <button
              type="button"
              class="ml-auto text-yellow-400 hover:text-yellow-600"
              onclick="this.parentElement.parentElement.remove()"
            >
              <i class="fas fa-times"></i>
            </button>
          </div>
        </div>

        <!-- Main Statistics Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          <div
            class="bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-lg p-6 shadow-lg hover:shadow-xl"
          >
            <div class="flex items-center justify-between">
              <div>
                <h4
                  class="text-2xl font-bold"
                  th:text="${summary.totalEntries ?: 0}"
                >
                  0
                </h4>
                <p class="text-blue-100">총 엔트리</p>
              </div>
              <div class="text-blue-200">
                <i class="fas fa-list text-3xl"></i>
              </div>
            </div>
          </div>
          <div
            class="bg-gradient-to-br from-green-500 to-green-600 text-white rounded-lg p-6 shadow-lg hover:shadow-xl"
          >
            <div class="flex items-center justify-between">
              <div>
                <h4
                  class="text-2xl font-bold"
                  th:text="${summary.addEntries ?: 0}"
                >
                  0
                </h4>
                <p class="text-green-100">추가 엔트리</p>
              </div>
              <div class="text-green-200">
                <i class="fas fa-plus text-3xl"></i>
              </div>
            </div>
          </div>
          <div
            class="bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-lg p-6 shadow-lg hover:shadow-xl"
          >
            <div class="flex items-center justify-between">
              <div>
                <h4
                  class="text-2xl font-bold"
                  th:text="${(summary.certificateValidationStats['total'] ?: 0) + (summary.certificateValidationStats['totalMasterLists'] ?: 0)}"
                >
                  0
                </h4>
                <p class="text-purple-100">PKD 객체</p>
              </div>
              <div class="text-purple-200">
                <i class="fas fa-certificate text-3xl"></i>
              </div>
            </div>
          </div>
          <div
            th:class="'bg-gradient-to-br text-white rounded-lg p-6 shadow-lg hover:shadow-xl ' + ${(summary.totalErrors ?: #lists.size(summary.errors)) > 0 ? 'from-red-500 to-red-600' : 'from-gray-400 to-gray-500'}"
          >
            <div class="flex items-center justify-between">
              <div>
                <h4
                  class="text-2xl font-bold"
                  th:text="${summary.totalErrors ?: #lists.size(summary.errors)}"
                >
                  0
                </h4>
                <p
                  th:class="${(summary.totalErrors ?: #lists.size(summary.errors)) > 0 ? 'text-red-100' : 'text-gray-100'}"
                >
                  오류
                </p>
              </div>
              <div
                th:class="${(summary.totalErrors ?: #lists.size(summary.errors)) > 0 ? 'text-red-200' : 'text-gray-200'}"
              >
                <i class="fas fa-exclamation-triangle text-3xl"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- PKD Components Analysis -->
        <div
          th:if="${summary?.certificateValidationStats != null and !#maps.isEmpty(summary.certificateValidationStats)}"
          class="mb-8"
        >
          <div th:if="${((summary.certificateValidationStats['total'] ?: 0) > 0) || ((summary.certificateValidationStats['totalCrls'] ?: 0) > 0)}"
            th:classappend="${((summary.certificateValidationStats['total'] ?: 0) > 0) && ((summary.certificateValidationStats['totalCrls'] ?: 0) > 0)} ? 'grid grid-cols-1 lg:grid-cols-2 gap-6' : 'grid grid-cols-1 gap-6'">
            <!-- DSC Certificate Analysis -->
            <div
                th:if="${(summary.certificateValidationStats['total'] ?: 0) > 0}"
                class="bg-white rounded-lg shadow-md overflow-hidden"
              >
                <div
                  class="bg-gradient-to-r from-emerald-600 to-emerald-700 text-white px-6 py-4"
                >
                  <h5 class="text-xl font-semibold flex items-center">
                    <i class="fas fa-certificate mr-2"></i> DSC 인증서 분석
                    <span class="ml-2 bg-emerald-500 px-2 py-1 rounded-full text-sm"
                      th:text="${summary.certificateValidationStats['total']}">0</span>
                  </h5>
                </div>
                <div class="p-6">
                  <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="text-center p-4 bg-green-50 rounded-lg border-2 border-green-200">
                      <div class="text-3xl font-bold text-green-600"
                        th:text="${summary.certificateValidationStats['valid'] ?: 0}">
                        0
                      </div>
                      <div class="text-gray-600 text-sm">유효한 인증서</div>
                    </div>
                    <div class="text-center p-4 bg-red-50 rounded-lg border-2 border-red-200">
                      <div class="text-3xl font-bold text-red-600"
                        th:text="${summary.certificateValidationStats['invalid'] ?: 0}">
                        0
                      </div>
                      <div class="text-gray-600 text-sm">무효한 인증서</div>
                    </div>
                  </div>
    
                  <!-- Certificate Success Rate Progress -->
                  <div th:if="${(summary.certificateValidationStats['total'] ?: 0) > 0}">
                    <div class="flex justify-between items-center mb-2">
                      <span class="text-sm font-medium text-gray-700">유효율</span>
                      <span class="text-sm font-medium text-gray-900"
                        th:text="${T(java.lang.Math).round(((summary.certificateValidationStats['valid'] ?: 0) * 100.0) / (summary.certificateValidationStats['total'] ?: 1))} + '%'"
                      >0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                      <div class="bg-gradient-to-r from-green-500 to-green-600 h-3 rounded-full transition-all duration-1000 ease-out"
                        th:style="'width: ' + ${T(java.lang.Math).round(((summary.certificateValidationStats['valid'] ?: 0) * 100.0) / (summary.certificateValidationStats['total'] ?: 1))} + '%'"
                      ></div>
                    </div>
                  </div>
                </div>
            </div>
  
            <!-- CRL Analysis -->
            <div th:if="${(summary.certificateValidationStats['totalCrls'] ?: 0) > 0}"
                class="bg-white rounded-lg shadow-md overflow-hidden"
              >
                <div class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4">
                  <h5 class="text-xl font-semibold flex items-center">
                    <i class="fas fa-list-alt mr-2"></i> Master List 분석
                    <span class="ml-2 bg-blue-500 px-2 py-1 rounded-full text-sm"
                      th:text="${summary.certificateValidationStats['totalCrls']}"
                      >0</span>
                  </h5>
                </div>
                <div class="p-6">
                  <div class="grid grid-cols-2 gap-4 mb-4">
                    <div class="text-center p-4 bg-blue-50 rounded-lg border-2 border-blue-200"
                    >
                      <div class="text-3xl font-bold text-blue-600"
                        th:text="${summary.certificateValidationStats['validCrls'] ?: 0}"
                      >
                        0
                      </div>
                      <div class="text-gray-600 text-sm">유효한 목록</div>
                    </div>
                    <div class="text-center p-4 bg-orange-50 rounded-lg border-2 border-orange-200">
                      <div class="text-3xl font-bold text-orange-600"
                        th:text="${summary.certificateValidationStats['invalidCrls'] ?: 0}"
                      >
                        0
                      </div>
                      <div class="text-gray-600 text-sm">무효한 목록</div>
                    </div>
                  </div>
    
                  <!-- Master List Success Rate Progress -->
                  <div
                    th:if="${(summary.certificateValidationStats['totalMasterLists'] ?: 0) > 0}"
                  >
                    <div class="flex justify-between items-center mb-2">
                      <span class="text-sm font-medium text-gray-700">유효율</span>
                      <span class="text-sm font-medium text-gray-900"
                        th:text="${T(java.lang.Math).round(((summary.certificateValidationStats['validMasterLists'] ?: 0) * 100.0) / (summary.certificateValidationStats['totalMasterLists'] ?: 1))} + '%'"
                      >0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                      <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-1000 ease-out"
                        th:style="'width: ' + ${T(java.lang.Math).round(((summary.certificateValidationStats['validMasterLists'] ?: 0) * 100.0) / (summary.certificateValidationStats['totalMasterLists'] ?: 1))} + '%'"
                      ></div>
                    </div>
                  </div>
                </div>
            </div>
          </div>
          <!-- Master List Analysis -->
          <div th:if="${(summary.certificateValidationStats['totalMasterLists'] ?: 0) > 0}"
            class="bg-white rounded-lg shadow-md overflow-hidden"
          >
            <div class="bg-gradient-to-r from-blue-600 to-blue-700 text-white px-6 py-4">
              <h5 class="text-xl font-semibold flex items-center">
                <i class="fas fa-list-alt mr-2"></i> Master List 분석
                <span class="ml-2 bg-blue-500 px-2 py-1 rounded-full text-sm"
                  th:text="${summary.certificateValidationStats['totalMasterLists']}"
                  >0</span>
              </h5>
            </div>
            <div class="p-6">
              <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="text-center p-4 bg-blue-50 rounded-lg border-2 border-blue-200"
                >
                  <div class="text-3xl font-bold text-blue-600"
                    th:text="${summary.certificateValidationStats['validMasterLists'] ?: 0}"
                  >
                    0
                  </div>
                  <div class="text-gray-600 text-sm">유효한 목록</div>
                </div>
                <div class="text-center p-4 bg-orange-50 rounded-lg border-2 border-orange-200">
                  <div class="text-3xl font-bold text-orange-600"
                    th:text="${summary.certificateValidationStats['invalidMasterLists'] ?: 0}"
                  >
                    0
                  </div>
                  <div class="text-gray-600 text-sm">무효한 목록</div>
                </div>
              </div>

              <!-- Master List Success Rate Progress -->
              <div
                th:if="${(summary.certificateValidationStats['totalMasterLists'] ?: 0) > 0}"
              >
                <div class="flex justify-between items-center mb-2">
                  <span class="text-sm font-medium text-gray-700">유효율</span>
                  <span class="text-sm font-medium text-gray-900"
                    th:text="${T(java.lang.Math).round(((summary.certificateValidationStats['validMasterLists'] ?: 0) * 100.0) / (summary.certificateValidationStats['totalMasterLists'] ?: 1))} + '%'"
                  >0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-3 overflow-hidden">
                  <div class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${T(java.lang.Math).round(((summary.certificateValidationStats['validMasterLists'] ?: 0) * 100.0) / (summary.certificateValidationStats['totalMasterLists'] ?: 1))} + '%'"
                  ></div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Combined PKD Overview (when both certificates and master lists exist) -->
        <div
          th:if="${summary?.certificateValidationStats != null and !#maps.isEmpty(summary.certificateValidationStats) and (summary.certificateValidationStats['total'] ?: 0) > 0 and (summary.certificateValidationStats['totalMasterLists'] ?: 0) > 0}"
          class="bg-white rounded-lg shadow-md mb-8 overflow-hidden"
        >
          <div
            class="bg-gradient-to-r from-indigo-600 to-indigo-700 text-white px-6 py-4"
          >
            <h5 class="text-xl font-semibold flex items-center">
              <i class="fas fa-shield-alt mr-2"></i> PKD 전체 현황
            </h5>
          </div>
          <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
              <div
                class="text-center p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl border border-green-200"
              >
                <div
                  class="text-2xl font-bold text-green-700 mb-1"
                  th:text="${(summary.certificateValidationStats['valid'] ?: 0) + (summary.certificateValidationStats['validMasterLists'] ?: 0)}"
                >
                  0
                </div>
                <div class="text-green-600 text-sm font-medium">총 유효</div>
              </div>
              <div
                class="text-center p-4 bg-gradient-to-br from-red-50 to-red-100 rounded-xl border border-red-200"
              >
                <div
                  class="text-2xl font-bold text-red-700 mb-1"
                  th:text="${(summary.certificateValidationStats['invalid'] ?: 0) + (summary.certificateValidationStats['invalidMasterLists'] ?: 0)}"
                >
                  0
                </div>
                <div class="text-red-600 text-sm font-medium">총 무효</div>
              </div>
              <div
                class="text-center p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl border border-blue-200"
              >
                <div
                  class="text-2xl font-bold text-blue-700 mb-1"
                  th:text="${(summary.certificateValidationStats['total'] ?: 0) + (summary.certificateValidationStats['totalMasterLists'] ?: 0)}"
                >
                  0
                </div>
                <div class="text-blue-600 text-sm font-medium">총 객체</div>
              </div>
              <div
                class="text-center p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl border border-purple-200"
              >
                <div
                  class="text-2xl font-bold text-purple-700 mb-1"
                  th:text="${T(java.lang.Math).round((((summary.certificateValidationStats['valid'] ?: 0) + (summary.certificateValidationStats['validMasterLists'] ?: 0)) * 100.0) / ((summary.certificateValidationStats['total'] ?: 0) + (summary.certificateValidationStats['totalMasterLists'] ?: 0) ?: 1))} + '%'"
                >
                  0%
                </div>
                <div class="text-purple-600 text-sm font-medium">
                  전체 유효율
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Errors and Warnings Section -->
        <div
          th:if="${summary.hasValidationErrors}"
          class="bg-white rounded-lg shadow-md mb-8 overflow-hidden"
        >
          <div
            class="bg-gradient-to-r from-red-600 to-red-700 text-white px-6 py-4"
          >
            <h5 class="text-xl font-semibold flex items-center">
              <i class="fas fa-exclamation-triangle mr-2"></i> 발견된 오류
              <span
                class="ml-2 bg-red-500 px-2 py-1 rounded-full text-sm"
                th:text="${#lists.size(summary.errors)}"
                >0</span
              >
              <span
                th:if="${summary.totalErrors > #lists.size(summary.errors)}"
                class="ml-2 text-red-200 text-sm"
              >
                (처음 10개만 표시, 총 [[${summary.totalErrors}]]개)
              </span>
            </h5>
          </div>
          <div class="p-6">
            <div
              class="bg-red-50 border border-red-200 rounded-lg p-4 max-h-60 overflow-y-auto"
            >
              <ul class="list-disc pl-5 space-y-2 text-red-800">
                <li
                  th:each="error : ${summary.errors}"
                  th:text="${error}"
                  class="leading-relaxed"
                ></li>
              </ul>
            </div>
          </div>
        </div>

        <!-- Warnings Section -->
        <div
          th:if="${!#lists.isEmpty(summary.warnings)}"
          class="bg-white rounded-lg shadow-md mb-8 overflow-hidden"
        >
          <div
            class="bg-gradient-to-r from-yellow-600 to-yellow-700 text-white px-6 py-4"
          >
            <h5 class="text-xl font-semibold flex items-center">
              <i class="fas fa-exclamation-triangle mr-2"></i> 경고
              <span
                class="ml-2 bg-yellow-500 px-2 py-1 rounded-full text-sm"
                th:text="${#lists.size(summary.warnings)}"
                >0</span
              >
              <span
                th:if="${summary.totalWarnings > #lists.size(summary.warnings)}"
                class="ml-2 text-yellow-200 text-sm"
              >
                (처음 10개만 표시, 총 [[${summary.totalWarnings}]]개)
              </span>
            </h5>
          </div>
          <div class="p-6">
            <div
              class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 max-h-60 overflow-y-auto"
            >
              <ul class="list-disc pl-5 space-y-2 text-yellow-800">
                <li
                  th:each="warning : ${summary.warnings}"
                  th:text="${warning}"
                  class="leading-relaxed"
                ></li>
              </ul>
            </div>
          </div>
        </div>

        <!-- EntryType Statistics Section -->
        <div
          th:if="${summary?.entryTypeCount != null and !#maps.isEmpty(summary.entryTypeCount)}"
          class="bg-white rounded-lg shadow-md mb-8 overflow-hidden"
        >
          <div
            class="bg-gradient-to-r from-gray-600 to-gray-700 text-white px-6 py-4"
          >
            <h5 class="text-xl font-semibold flex items-center">
              <i class="fas fa-chart-pie mr-2"></i> EntryType 통계
              <span
                class="ml-2 bg-gray-500 px-2 py-1 rounded-full text-sm"
                th:text="${#maps.size(summary.entryTypeCount)}"
                >0</span
              >
            </h5>
          </div>
          <div class="p-6">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
              <!-- Master List -->
              <div
                th:if="${summary.entryTypeCount.containsKey('ML')}"
                class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border-2 border-purple-200 hover:shadow-md transition-shadow duration-200"
              >
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center">
                    <i class="fas fa-list-alt text-purple-600 mr-2"></i>
                    <span class="text-purple-800 font-semibold text-lg"
                      >Master List</span
                    >
                  </div>
                  <span
                    class="bg-purple-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm"
                    th:text="${summary.entryTypeCount['ML']}"
                    >0</span
                  >
                </div>
                <div
                  class="w-full bg-purple-200 rounded-full h-3 overflow-hidden"
                >
                  <div
                    class="bg-gradient-to-r from-purple-500 to-purple-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${summary.entryTypeCount['ML'] * 100 / summary.totalEntries} + '%'"
                  ></div>
                </div>
                <div
                  class="text-xs text-purple-600 mt-2 text-center font-medium"
                >
                  <span
                    th:text="${T(java.lang.Math).round(summary.entryTypeCount['ML'] * 100.0 / summary.totalEntries)}"
                    >0</span
                  >% of total
                </div>
              </div>

              <!-- DSC -->
              <div
                th:if="${summary.entryTypeCount.containsKey('DSC')}"
                class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border-2 border-green-200 hover:shadow-md transition-shadow duration-200"
              >
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center">
                    <i class="fas fa-certificate text-green-600 mr-2"></i>
                    <span class="text-green-800 font-semibold text-lg"
                      >DSC</span
                    >
                  </div>
                  <span
                    class="bg-green-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm"
                    th:text="${summary.entryTypeCount['DSC']}"
                    >0</span
                  >
                </div>
                <div
                  class="w-full bg-green-200 rounded-full h-3 overflow-hidden"
                >
                  <div
                    class="bg-gradient-to-r from-green-500 to-green-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${summary.entryTypeCount['DSC'] * 100 / summary.totalEntries} + '%'"
                  ></div>
                </div>
                <div
                  class="text-xs text-green-600 mt-2 text-center font-medium"
                >
                  <span
                    th:text="${T(java.lang.Math).round(summary.entryTypeCount['DSC'] * 100.0 / summary.totalEntries)}"
                    >0</span
                  >% of total
                </div>
              </div>

              <!-- CRL -->
              <div
                th:if="${summary.entryTypeCount.containsKey('CRL')}"
                class="bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border-2 border-orange-200 hover:shadow-md transition-shadow duration-200"
              >
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center">
                    <i class="fas fa-ban text-orange-600 mr-2"></i>
                    <span class="text-orange-800 font-semibold text-lg"
                      >CRL</span
                    >
                  </div>
                  <span
                    class="bg-orange-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm"
                    th:text="${summary.entryTypeCount['CRL']}"
                    >0</span
                  >
                </div>
                <div
                  class="w-full bg-orange-200 rounded-full h-3 overflow-hidden"
                >
                  <div
                    class="bg-gradient-to-r from-orange-500 to-orange-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${summary.entryTypeCount['CRL'] * 100 / summary.totalEntries} + '%'"
                  ></div>
                </div>
                <div
                  class="text-xs text-orange-600 mt-2 text-center font-medium"
                >
                  <span
                    th:text="${T(java.lang.Math).round(summary.entryTypeCount['CRL'] * 100.0 / summary.totalEntries)}"
                    >0</span
                  >% of total
                </div>
              </div>

              <!-- Country -->
              <div
                th:if="${summary.entryTypeCount.containsKey('C')}"
                class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border-2 border-blue-200 hover:shadow-md transition-shadow duration-200"
              >
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center">
                    <i class="fas fa-flag text-blue-600 mr-2"></i>
                    <span class="text-blue-800 font-semibold text-lg"
                      >Country</span
                    >
                  </div>
                  <span
                    class="bg-blue-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm"
                    th:text="${summary.entryTypeCount['C']}"
                    >0</span
                  >
                </div>
                <div
                  class="w-full bg-blue-200 rounded-full h-3 overflow-hidden"
                >
                  <div
                    class="bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${summary.entryTypeCount['C'] * 100 / summary.totalEntries} + '%'"
                  ></div>
                </div>
                <div class="text-xs text-blue-600 mt-2 text-center font-medium">
                  <span
                    th:text="${T(java.lang.Math).round(summary.entryTypeCount['C'] * 100.0 / summary.totalEntries)}"
                    >0</span
                  >% of total
                </div>
              </div>

              <!-- Organization -->
              <div
                th:if="${summary.entryTypeCount.containsKey('O')}"
                class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-lg p-4 border-2 border-gray-200 hover:shadow-md transition-shadow duration-200"
              >
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center">
                    <i class="fas fa-building text-gray-600 mr-2"></i>
                    <span class="text-gray-800 font-semibold text-lg"
                      >Organization</span
                    >
                  </div>
                  <span
                    class="bg-gray-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm"
                    th:text="${summary.entryTypeCount['O']}"
                    >0</span
                  >
                </div>
                <div
                  class="w-full bg-gray-200 rounded-full h-3 overflow-hidden"
                >
                  <div
                    class="bg-gradient-to-r from-gray-500 to-gray-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${summary.entryTypeCount['O'] * 100 / summary.totalEntries} + '%'"
                  ></div>
                </div>
                <div class="text-xs text-gray-600 mt-2 text-center font-medium">
                  <span
                    th:text="${T(java.lang.Math).round(summary.entryTypeCount['O'] * 100.0 / summary.totalEntries)}"
                    >0</span
                  >% of total
                </div>
              </div>

              <!-- DC (Domain Component) -->
              <div
                th:if="${summary.entryTypeCount.containsKey('DC')}"
                class="bg-gradient-to-br from-teal-50 to-teal-100 rounded-lg p-4 border-2 border-teal-200 hover:shadow-md transition-shadow duration-200"
              >
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center">
                    <i class="fas fa-globe text-teal-600 mr-2"></i>
                    <span class="text-teal-800 font-semibold text-lg"
                      >Domain</span
                    >
                  </div>
                  <span
                    class="bg-teal-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm"
                    th:text="${summary.entryTypeCount['DC']}"
                    >0</span
                  >
                </div>
                <div
                  class="w-full bg-teal-200 rounded-full h-3 overflow-hidden"
                >
                  <div
                    class="bg-gradient-to-r from-teal-500 to-teal-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${summary.entryTypeCount['DC'] * 100 / summary.totalEntries} + '%'"
                  ></div>
                </div>
                <div class="text-xs text-teal-600 mt-2 text-center font-medium">
                  <span
                    th:text="${T(java.lang.Math).round(summary.entryTypeCount['DC'] * 100.0 / summary.totalEntries)}"
                    >0</span
                  >% of total
                </div>
              </div>

              <!-- Unknown/Other Types -->
              <div
                th:if="${summary.entryTypeCount.containsKey('UNKNOWN')}"
                class="bg-gradient-to-br from-indigo-50 to-indigo-100 rounded-lg p-4 border-2 border-indigo-200 hover:shadow-md transition-shadow duration-200"
              >
                <div class="flex items-center justify-between mb-3">
                  <div class="flex items-center">
                    <i class="fas fa-question-circle text-indigo-600 mr-2"></i>
                    <span class="text-indigo-800 font-semibold text-lg">기타</span>
                  </div>
                  <span class="bg-indigo-500 text-white px-3 py-1 rounded-full text-sm font-bold shadow-sm"
                    th:text="${summary.entryTypeCount['UNKNOWN']}"
                  >0</span>
                </div>
                <div
                  class="w-full bg-indigo-200 rounded-full h-3 overflow-hidden"
                >
                  <div
                    class="bg-gradient-to-r from-indigo-500 to-indigo-600 h-3 rounded-full transition-all duration-1000 ease-out"
                    th:style="'width: ' + ${summary.entryTypeCount['UNKNOWN'] * 100 / summary.totalEntries} + '%'"
                  ></div>
                </div>
                <div class="text-xs text-indigo-600 mt-2 text-center font-medium">
                  <span
                    th:text="${T(java.lang.Math).round(summary.entryTypeCount['UNKNOWN'] * 100.0 / summary.totalEntries)}"
                  >0</span>% of total
                </div>
              </div>
            </div>

            <!-- EntryType Description -->
            <div class="mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200">
              <h6 class="text-sm font-semibold text-gray-700 mb-3">
                <i class="fas fa-info-circle text-blue-500 mr-2"></i>EntryType 설명
              </h6>
              <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-xs text-gray-600">
                <div><strong>ML:</strong> Master List - PKD 마스터 목록</div>
                <div>
                  <strong>DSC:</strong> Document Signer Certificate - 문서 서명 인증서
                </div>
                <div>
                  <strong>CRL:</strong> Certificate Revocation List - 인증서 폐기 목록
                </div>
                <div><strong>C:</strong> Country - 국가 엔트리</div>
                <div><strong>O:</strong> Organization - 조직 엔트리</div>
                <div>
                  <strong>DC:</strong> Domain Component - 도메인 구성요소
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Save to LDAP Section -->
        <!-- 분석 결과 요약이 존재하고 검증 오류가 없고 전체 엔트리 개수 1개 이상 일 때 LDAP 저장 버튼 표시-->
        <div
          th:if="${summary != null and !summary.hasValidationErrors and summary.totalEntries > 0}"
          class="bg-white rounded-lg shadow-md mb-8 overflow-hidden"
        >
          <div
            class="bg-gradient-to-r from-green-600 to-green-700 text-white px-6 py-4"
          >
            <h5 class="text-xl font-semibold flex items-center">
              <i class="fas fa-database mr-2"></i> LDAP 저장
            </h5>
          </div>
          <div class="p-6">
            <!-- Save Info Card -->
            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
              <div class="flex items-start">
                <i class="fas fa-info-circle text-blue-500 mr-3 mt-1"></i>
                <div>
                  <h6 class="font-semibold text-blue-900 mb-2">저장 정보</h6>
                  <p class="text-blue-800 text-sm leading-relaxed">
                    • 분석 완료된 PKD 데이터를 OpenLDAP 서버에 저장합니다.<br />
                    • 총 <strong th:text="${summary.totalEntries}">0</strong>개의 엔트리가 저장됩니다.<br />
                    • DSC, CRL 및 Master List가 포함되어 있습니다.<br />
                    • 저장 중에는 페이지를 닫지 마세요.
                  </p>
                </div>
              </div>
            </div>

            <!-- Save Button and Controls -->
            <div id="saveControlsSection" class="mb-6">
              <div class="flex items-center space-x-4">
                <button
                  id="saveToLdapBtn"
                  onclick="startLdapSave()"
                  class="inline-flex items-center px-6 py-3 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white font-semibold rounded-lg transition-all duration-200 text-lg shadow-md hover:shadow-lg transform hover:scale-105 disabled:transform-none disabled:cursor-not-allowed"
                >
                  <i class="fas fa-save mr-2"></i> LDAP에 저장하기
                </button>
                <button
                  id="cancelTaskBtn"
                  onclick="cancelLdapSave()"
                  class="hidden inline-flex items-center px-4 py-2 bg-red-600 hover:bg-red-700 disabled:bg-gray-400 text-white font-medium rounded-lg transition-colors disabled:cursor-not-allowed"
                >
                  <i class="fas fa-times mr-2"></i> 작업 취소
                </button>
              </div>
            </div>

            <!-- Connection Status Display (최초 페이지 표시 및 저장 버튼 클릭 전에는 표시되지 않음) -->
            <div id="connectionStatus" class="hidden mb-4">
              <div class="bg-gray-50 border border-gray-200 rounded-lg p-4">
                <div class="flex items-center">
                  <div class="animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-3"></div>
                  <span class="text-gray-700 font-medium">서버 연결 중...</span>
                </div>
              </div>
            </div>

            <!-- LDAP Progress Container -->
            <div id="ldapProgressContainer" class="hidden">
              <!-- 초기 상태 표시 -->
              <div id="initialProgressState" class="bg-gradient-to-br from-indigo-50 to-blue-50 border border-indigo-200 rounded-lg p-6">
                <div class="flex items-center justify-between mb-3">
                  <span class="text-indigo-800 font-semibold text-lg">LDAP 저장 준비 중...</span>
                  <span class="text-indigo-700 font-bold text-lg">0%</span>
                </div>
                <div class="w-full bg-indigo-100 rounded-full h-6 overflow-hidden shadow-inner">
                  <div class="bg-gradient-to-r from-indigo-500 to-indigo-600 h-6 rounded-full transition-all duration-300" style="width: 0%">
                  </div>
                </div>
                <div class="mt-4 text-center">
                  <div class="animate-pulse text-indigo-600">서버 연결을 설정하고 있습니다...</div>
                </div>
              </div>
              
              <!-- SSE 진행률 표시 영역 -->
              <div id="ldapProgressSection" class="mt-6">
                <!-- SSE를 통해 동적으로 업데이트되는 영역 -->
              </div>
            </div>

            <!-- Save Result Messages -->
            <div id="saveResult" class="mt-4"></div>
          </div>
        </div>
      </div>
    </div>
    <th:block layout:fragment="script-content">
      <script type="text/javascript" th:src="@{/webjars/htmx-ext-sse/dist/sse.js}"></script>
      <script th:inline="javascript">
        // Global variables
        const sessionId = /*[[${sessionId}]]*/ "";
        let currentTaskId = null;
        let ldapSSEConnected = false;
        let sseEventSource = null;

        console.log("Analysis result page loaded with sessionId:", sessionId);

        // LDAP 저장 시작 함수
        function startLdapSave() {
          console.log("Starting LDAP save process...");
          
          // UI 상태 업데이트
          updateSaveUI("preparing");
          
          // 연결 상태 표시
          showConnectionStatus();
          
          // AJAX 요청으로 LDAP 저장 시작
          fetch(`/ldif/save-to-ldap/${sessionId}`, {
            method: 'POST',
            headers: {
              'X-Requested-With': 'XMLHttpRequest',
              'HX-Request': 'true'
            }
          })
          .then(response => response.json())
          .then(data => {
            console.log("LDAP save response:", data);
            hideConnectionStatus();
            
            if (data.success && data.sessionId) {
              console.log("LDAP save task started successfully:", data.sessionId);
              currentTaskId = data.sessionId;
              setupLdapSSEConnection(data.sessionId);
              updateSaveUI("saving");
            } else {
              console.error("LDAP save failed to start:", data.message);
              handleSaveError(data.message || "LDAP 저장 시작 실패");
              updateSaveUI("ready");
            }
          })
          .catch(error => {
            console.error("Error starting LDAP save:", error);
            hideConnectionStatus();
            handleSaveError("서버 요청 중 오류가 발생했습니다: " + error.message);
            updateSaveUI("ready");
          });
        }

        // LDAP 저장 취소 함수
        function cancelLdapSave() {
          console.log("Cancelling LDAP save...");
          
          if (sseEventSource) {
            sseEventSource.close();
            sseEventSource = null;
            console.log("SSE connection closed");
          }
          
          currentTaskId = null;
          ldapSSEConnected = false;
          
          updateSaveUI("ready");
          
          // 취소 메시지 표시
          showSaveResult("작업이 취소되었습니다.", "warning");
        }

        // UI 상태 업데이트 함수
        function updateSaveUI(state) {
          const saveBtn = document.getElementById("saveToLdapBtn");
          const cancelBtn = document.getElementById("cancelTaskBtn");
          const progressContainer = document.getElementById("ldapProgressContainer");
          
          switch (state) {
            case "preparing": //  저장 준비(서버 연결 및 저장 명령 실행 대기) 상태 이면
              if (saveBtn) {
                saveBtn.disabled = true; // 저장 버튼 클릭 방지
                saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> 연결 준비 중...';
              }
              if (cancelBtn) {
                cancelBtn.classList.remove("hidden"); // 취소 버튼 표시
              }
              break;
              
            case "saving":  // 저장 중 상태 이면
              if (saveBtn) {
                saveBtn.disabled = true;  // 저장 버튼 클릭 방지
                saveBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i> 저장 중...';
              }
              if (cancelBtn) {
                cancelBtn.classList.remove("hidden"); // 취소 버튼 표시
              }
              if (progressContainer) {
                progressContainer.classList.remove("hidden"); // 프로그램 바 표시
              }
              break;
              
            case "completed": // 완료 상태 이면
              if (saveBtn) {
                saveBtn.disabled = false; // 저장 버튼 클릭 가능
                saveBtn.innerHTML = '<i class="fas fa-check mr-2"></i> 저장 완료';
                saveBtn.classList.remove("bg-green-600", "hover:bg-green-700");
                saveBtn.classList.add("bg-green-500");
              }
              if (cancelBtn) {
                cancelBtn.classList.add("hidden");
              }
              // 진행률 컨테이너는 유지하여 완료 상태 표시
              break;
              
            case "ready":
            default:        // 최초 화면 표시 및 저장 버튼 클릭 전 혹은 해당 상태 값이 아닌 경우
              if (saveBtn) {
                saveBtn.disabled = false;   // 클릭 가능
                saveBtn.innerHTML = '<i class="fas fa-save mr-2"></i> LDAP에 저장하기';
                saveBtn.classList.remove("bg-green-500");
                saveBtn.classList.add("bg-green-600", "hover:bg-green-700");
              }
              if (cancelBtn) {
                cancelBtn.classList.add("hidden"); // 취소 버튼 숨기기
              }
              if (progressContainer) {
                progressContainer.classList.add("hidden"); // 프로그래스 바 숨기기
              }
              break;
          }
        }

        // 연결 상태 표시
        function showConnectionStatus() {
          const statusDiv = document.getElementById("connectionStatus");
          if (statusDiv) {
            statusDiv.classList.remove("hidden");
          }
        }

        // 연결 상태 숨기기
        function hideConnectionStatus() {
          const statusDiv = document.getElementById("connectionStatus");
          if (statusDiv) {
            statusDiv.classList.add("hidden");
          }
        }

        // SSE 연결 설정
        function setupLdapSSEConnection(sessionId) {
          console.log("Setting up SSE connection for session:", sessionId);
          
          // 기존 연결이 있다면 정리
          if (sseEventSource) {
            sseEventSource.close();
          }
          
          // 새로운 SSE 연결 생성
          sseEventSource = new EventSource(`/ldap-progress/${sessionId}`);
          
          sseEventSource.onopen = function(event) {
            console.log("SSE connection opened");
            ldapSSEConnected = true;
            showToast("LDAP 저장 연결이 설정되었습니다", "info");
          };
          
          sseEventSource.onmessage = function(event) {
            console.log("SSE message received:", event);
          };
          
          // LDAP 진행률 이벤트 처리
          sseEventSource.addEventListener('ldap-progress', function(event) {
            console.log("LDAP progress event:", event.data);
            updateProgressDisplay(event.data);
          });
          
          // 연결 설정 이벤트 처리
          sseEventSource.addEventListener('connection-established', function(event) {
            console.log("SSE connection established:", event.data);
          });
          
          // 하트비트 이벤트 처리
          sseEventSource.addEventListener('heartbeat', function(event) {
            console.debug("SSE heartbeat received");
          });
          
          sseEventSource.onerror = function(event) {
            console.error("SSE connection error:", event);
            ldapSSEConnected = false;
            
            // 연결 오류 처리
            if (sseEventSource.readyState === EventSource.CLOSED) {
              console.log("SSE connection closed");
              showToast("연결이 종료되었습니다", "warning");
            } else {
              console.log("SSE connection error, attempting reconnection...");
              showToast("연결 오류가 발생했습니다. 재연결을 시도합니다.", "warning");
              
              // 3초 후 재연결 시도
              setTimeout(() => {
                if (currentTaskId) {
                  console.log("Attempting SSE reconnection...");
                  setupLdapSSEConnection(currentTaskId);
                }
              }, 3000);
            }
          };
        }

        // 진행률 표시 업데이트
        function updateProgressDisplay(htmlContent) {
          const progressSection = document.getElementById("ldapProgressSection");
          const initialState = document.getElementById("initialProgressState");
          
          if (progressSection) {
            progressSection.innerHTML = htmlContent;
            
            // 초기 상태 숨기기
            if (initialState) {
              initialState.style.display = 'none';
            }
          }
          
          // 완료 상태 확인
          if (htmlContent.includes('저장 완료') || htmlContent.includes('100%')) {
            setTimeout(() => {
              updateSaveUI("completed");
              if (sseEventSource) {
                sseEventSource.close();
                sseEventSource = null;
              }
              currentTaskId = null;
            }, 2000);
          }
        }

        // 저장 오류 처리
        function handleSaveError(message) {
          console.error("LDAP save error:", message);
          showSaveResult(message, "error");
          updateSaveUI("ready");
          
          if (sseEventSource) {
            sseEventSource.close();
            sseEventSource = null;
          }
          
          currentTaskId = null;
          ldapSSEConnected = false;
        }

        // 결과 메시지 표시
        function showSaveResult(message, type = "info") {
          const saveResult = document.getElementById("saveResult");
          if (!saveResult) return;
          
          const typeConfig = {
            success: {
              bg: "bg-green-50 border-green-200",
              text: "text-green-800",
              icon: "fa-check-circle text-green-500"
            },
            error: {
              bg: "bg-red-50 border-red-200", 
              text: "text-red-800",
              icon: "fa-exclamation-triangle text-red-500"
            },
            warning: {
              bg: "bg-yellow-50 border-yellow-200",
              text: "text-yellow-800", 
              icon: "fa-exclamation-triangle text-yellow-500"
            },
            info: {
              bg: "bg-blue-50 border-blue-200",
              text: "text-blue-800",
              icon: "fa-info-circle text-blue-500"
            }
          };
          
          const config = typeConfig[type] || typeConfig.info;
          
          saveResult.innerHTML = `
            <div class="${config.bg} border rounded-lg p-4 animate-fadeIn">
              <div class="flex items-start">
                <i class="fas ${config.icon} mr-3 mt-1"></i>
                <div class="flex-1">
                  <div class="${config.text} font-medium">${message}</div>
                </div>
                <button type="button" class="ml-auto ${config.text.replace('text-', 'text-').replace('-800', '-400')} hover:${config.text.replace('-800', '-600')}" onclick="this.parentElement.parentElement.remove()">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            </div>
          `;
        }

        // Toast 알림 표시
        function showToast(message, type = "success") {
          // 기존 토스트 제거
          const existingToast = document.getElementById("toastNotification");
          if (existingToast) {
            existingToast.remove();
          }

          const typeConfig = {
            success: { bg: "bg-green-600", icon: "fa-check" },
            error: { bg: "bg-red-600", icon: "fa-exclamation-triangle" },
            warning: { bg: "bg-yellow-600", icon: "fa-exclamation-triangle" },
            info: { bg: "bg-blue-600", icon: "fa-info-circle" }
          };
          
          const config = typeConfig[type] || typeConfig.info;
          
          const toast = document.createElement("div");
          toast.id = "toastNotification";
          toast.className = `fixed top-4 right-4 z-50 px-4 py-3 rounded-lg shadow-lg text-white font-medium transform transition-all duration-300 translate-x-full ${config.bg}`;
          
          toast.innerHTML = `
            <div class="flex items-center">
              <i class="fas ${config.icon} mr-2"></i>
              ${message}
            </div>
          `;

          document.body.appendChild(toast);

          // 토스트 표시
          setTimeout(() => {
            toast.classList.remove("translate-x-full");
          }, 100);

          // 3초 후 자동 제거
          setTimeout(() => {
            toast.classList.add("translate-x-full");
            setTimeout(() => {
              if (document.body.contains(toast)) {
                document.body.removeChild(toast);
              }
            }, 300);
          }, 3000);
        }

        // 페이지 언로드 시 정리
        window.addEventListener("beforeunload", function() {
          console.log("Page unloading, cleaning up SSE connections...");
          if (sseEventSource) {
            sseEventSource.close();
            sseEventSource = null;
          }
        });

        // 페이지 로드 완료 시 초기화
        document.addEventListener("DOMContentLoaded", function() {
          console.log("DOM loaded, page ready for LDAP save operations");
          updateSaveUI("ready");
        });
      </script>
      <style>
        @keyframes fadeIn {
          from {
            opacity: 0;
            transform: translateY(10px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .animate-fadeIn {
          animation: fadeIn 0.3s ease-out;
        }

        /* Enhanced loading spinner */
        @keyframes spin {
          to {
            transform: rotate(360deg);
          }
        }

        .animate-spin {
          animation: spin 1s linear infinite;
        }

        /* Pulse animation for loading states */
        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.5;
          }
        }

        .animate-pulse {
          animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        /* Custom scrollbar styling */
        .overflow-y-auto::-webkit-scrollbar {
          width: 8px;
        }

        .overflow-y-auto::-webkit-scrollbar-track {
          background: #f1f5f9;
          border-radius: 4px;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb {
          background: #cbd5e1;
          border-radius: 4px;
        }

        .overflow-y-auto::-webkit-scrollbar-thumb:hover {
          background: #94a3b8;
        }

        /* Enhanced hover effects */
        .hover\:shadow-xl:hover {
          transform: translateY(-2px);
        }

        .hover\:scale-105:hover {
          transform: scale(1.05);
        }

        /* Progress bar animations */
        .transition-all {
          transition-property: all;
          transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        }

        .duration-300 {
          transition-duration: 300ms;
        }

        .duration-1000 {
          transition-duration: 1000ms;
        }

        .ease-out {
          transition-timing-function: cubic-bezier(0, 0, 0.2, 1);
        }

        /* Button interaction improvements */
        .transform {
          transform: translateZ(0);
        }

        .disabled\:transform-none:disabled {
          transform: none;
        }

        .disabled\:cursor-not-allowed:disabled {
          cursor: not-allowed;
        }

        /* Connection status styling */
        #connectionStatus {
          transition: all 0.3s ease-in-out;
        }

        #connectionStatus.hidden {
          opacity: 0;
          transform: translateY(-10px);
        }

        /* Progress container styling */
        #ldapProgressContainer {
          transition: all 0.5s ease-in-out;
        }

        #ldapProgressContainer.hidden {
          opacity: 0;
          max-height: 0;
          overflow: hidden;
        }

        #ldapProgressContainer:not(.hidden) {
          opacity: 1;
          max-height: 1000px;
        }

        /* Toast notification positioning */
        #toastNotification {
          z-index: 9999;
        }

        /* Smooth transitions for all interactive elements */
        button, .transition-colors {
          transition: all 0.2s ease-in-out;
        }

        /* Loading state visual improvements */
        .bg-gradient-to-br {
          background-attachment: fixed;
        }

        /* Progress bar glow effect */
        .shadow-inner {
          box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.1);
        }

        /* Card hover effects */
        .shadow-lg {
          box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }

        .hover\:shadow-xl:hover {
          box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
          .container {
            padding-left: 1rem;
            padding-right: 1rem;
          }
          
          .grid-cols-1.md\:grid-cols-2.lg\:grid-cols-4 {
            grid-template-columns: repeat(1, minmax(0, 1fr));
          }
          
          .text-3xl {
            font-size: 1.875rem;
          }
          
          .text-2xl {
            font-size: 1.5rem;
          }
        }

        /* Focus states for accessibility */
        button:focus, .focus\:ring:focus {
          outline: 2px solid transparent;
          outline-offset: 2px;
          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
        }

        /* Error state animations */
        .animate-shake {
          animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-5px); }
          75% { transform: translateX(5px); }
        }
      </style>
    </th:block>
  </body>
</html>
