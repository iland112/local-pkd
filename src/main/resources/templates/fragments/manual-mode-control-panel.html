<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
>
  <!-- Manual Mode Control Panel Fragment
       MANUAL λ¨λ“μ—μ„ κ° μ²λ¦¬ λ‹¨κ³„λ¥Ό μλ™μΌλ΅ μ§„ν–‰ν•  μ μλ” μ»¨νΈλ΅¤ ν¨λ„

       μ‚¬μ© μμ‹:
       <th:block th:replace="~{fragments/manual-mode-control-panel :: control-panel(uploadId='abc-123')}">
  -->

  <th:block th:fragment="control-panel(uploadId='')">
    <!-- Panel only visible in MANUAL mode -->
    <div x-show="processingMode === 'MANUAL'" x-transition class="mt-6">
      <div class="card bg-secondary bg-opacity-10 border-2 border-secondary">
        <div class="card-body">
          <h3 class="card-title text-lg text-secondary">
            <i class="fas fa-list-ol text-secondary mr-2"></i>
            λ‹¨κ³„λ³„ μ²λ¦¬ μ μ–΄
          </h3>

          <!-- Step Indicator -->
          <div class="mt-4">
            <ul class="steps steps-vertical w-full">
              <!-- Step 1: Upload Completed -->
              <li class="step step-primary">
                <div class="flex-1">
                  <p class="font-semibold">νμΌ μ—…λ΅λ“</p>
                  <p class="text-xs opacity-70">νμΌμ΄ μ—…λ΅λ“λμ—μµλ‹λ‹¤</p>
                </div>
              </li>

              <!-- Step 2: Parsing -->
              <li class="step" id="parsingStep">
                <div class="flex-1">
                  <p class="font-semibold">LDIF νμ‹±</p>
                  <p class="text-xs opacity-70">νμΌμ„ νμ‹±ν•μ—¬ μΈμ¦μ„λ¥Ό μ¶”μ¶ν•©λ‹λ‹¤</p>
                </div>
              </li>

              <!-- Step 3: Validation -->
              <li class="step" id="validationStep">
                <div class="flex-1">
                  <p class="font-semibold">μΈμ¦μ„ κ²€μ¦</p>
                  <p class="text-xs opacity-70">μ¶”μ¶λ μΈμ¦μ„μ μ ν¨μ„±μ„ κ²€μ¦ν•©λ‹λ‹¤</p>
                </div>
              </li>

              <!-- Step 4: LDAP Upload -->
              <li class="step" id="ldapStep">
                <div class="flex-1">
                  <p class="font-semibold">LDAP μ„λ²„ μ €μ¥</p>
                  <p class="text-xs opacity-70">κ²€μ¦λ μΈμ¦μ„λ¥Ό LDAP μ„λ²„μ— μ €μ¥ν•©λ‹λ‹¤</p>
                </div>
              </li>
            </ul>
          </div>

          <!-- Action Buttons -->
          <div class="card-actions justify-center gap-3 mt-6 flex-wrap">
            <!-- Parsing Button -->
            <button
              type="button"
              id="parseBtn"
              @click="triggerStep('parse')"
              :disabled="parsingStarted"
              class="btn btn-sm gap-2"
              :class="parsingStarted ? 'btn-success' : 'btn-primary'"
            >
              <i class="fas" :class="parsingStarted ? 'fa-check-circle' : 'fa-play'"></i>
              <span x-text="parsingStarted ? 'νμ‹± μ™„λ£' : 'νμ‹± μ‹μ‘'"></span>
            </button>

            <!-- Validation Button -->
            <button
              type="button"
              id="validateBtn"
              @click="triggerStep('validate')"
              :disabled="!parsingStarted || validationStarted"
              class="btn btn-sm gap-2"
              :class="validationStarted ? 'btn-success' : 'btn-primary'"
            >
              <i class="fas" :class="validationStarted ? 'fa-check-circle' : 'fa-play'"></i>
              <span x-text="validationStarted ? 'κ²€μ¦ μ™„λ£' : 'κ²€μ¦ μ‹μ‘'"></span>
            </button>

            <!-- LDAP Upload Button -->
            <button
              type="button"
              id="ldapBtn"
              @click="triggerStep('ldap')"
              :disabled="!validationStarted || ldapStarted"
              class="btn btn-sm gap-2"
              :class="ldapStarted ? 'btn-success' : 'btn-primary'"
            >
              <i class="fas" :class="ldapStarted ? 'fa-check-circle' : 'fa-play'"></i>
              <span x-text="ldapStarted ? 'LDAP μ €μ¥ μ™„λ£' : 'LDAP μ €μ¥ μ‹μ‘'"></span>
            </button>
          </div>

          <!-- Progress Display -->
          <div x-show="isProcessing" x-transition class="mt-4 border-t pt-4">
            <div class="flex items-center gap-2 mb-2">
              <i class="fas fa-spinner fa-spin text-primary"></i>
              <span class="text-sm font-semibold" x-text="currentStepMessage"></span>
            </div>
            <progress id="stepProgress" class="progress progress-primary w-full" x-bind:value="stepPercentage" max="100"></progress>
            <p class="text-xs text-center mt-2 opacity-70" x-text="stepPercentage + '%'"></p>
          </div>

          <!-- Error Display -->
          <div x-show="stepError" x-transition class="alert alert-error mt-4">
            <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
            <div>
              <h3 class="font-bold">μ²λ¦¬ μ¤λ¥</h3>
              <div class="text-xs" x-text="stepError"></div>
            </div>
            <button type="button" @click="stepError = null" class="btn btn-sm btn-ghost">λ‹«κΈ°</button>
          </div>

          <!-- Info Alert -->
          <div class="alert alert-info mt-4">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
            <div class="text-xs">
              <p class="font-semibold mb-1">π’΅ MANUAL λ¨λ“ μ‚¬μ© κ°€μ΄λ“</p>
              <ul class="list-disc list-inside space-y-1">
                <li>κ° λ‹¨κ³„λ” μμ„λ€λ΅ μ§„ν–‰λμ–΄μ•Ό ν•©λ‹λ‹¤</li>
                <li>κ° λ‹¨κ³„μ λ²„νΌμ„ ν΄λ¦­ν•λ©΄ μ²λ¦¬κ°€ μ‹μ‘λ©λ‹λ‹¤</li>
                <li>μ²λ¦¬ μ¤‘μ—λ” λ‹¤μ λ‹¨κ³„μ λ²„νΌμ΄ λΉ„ν™μ„±ν™”λ©λ‹λ‹¤</li>
                <li>μ¤‘κ°„ κ²°κ³Όλ¥Ό κ²€ν† ν• ν›„ λ‹¤μ λ‹¨κ³„λ΅ μ§„ν–‰ν•  μ μμµλ‹λ‹¤</li>
                <li>μ¤λ¥ λ°μƒ μ‹ μ¤λ¥ λ©”μ‹μ§€λ¥Ό ν™•μΈν•κ³  μ¬μ‹λ„ν•  μ μμµλ‹λ‹¤</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </th:block>
</html>
